{
  "âš ï¸ CRITICAL_WARNING": "ÐÐ• ÐŸÐ•Ð Ð•ÐŸÐ˜Ð¡Ð«Ð’ÐÐ™ ÐŸÐ ÐžÐ•ÐšÐ¢ Ð¡ ÐÐ£Ð›Ð¯! ÐÐ• ÐŸÐ•Ð Ð•Ð”Ð•Ð›Ð«Ð’ÐÐ™ Ð‘ÐžÐ¢Ð! Ð ÐÐ‘ÐžÐ¢ÐÐ•Ðœ ÐÐÐ” ÐÐ”ÐœÐ˜ÐÐšÐžÐ™!",

  "task": {
    "title": "Fix Admin Panel E2E Tests",
    "description": "Fix 3 critical blockers to achieve 18/18 passing E2E tests for admin panel",
    "current_status": "8/18 tests passing (44% success rate)",
    "target": "18/18 tests passing (100%)",
    "last_commit": "d4df5f3 - feat(ui): Add alert-dialog and tooltip shadcn components",
    "working_directory": "/Users/serjnavigatian/Projects/tg-final/packages/ui"
  },

  "âš¡ MANDATORY_RULES": {
    "1_sequential_thinking": {
      "rule": "Ð’Ð¡Ð•Ð“Ð”Ð Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ mcp__sequential-thinking__sequentialthinking Ð´Ð»Ñ ÐšÐÐ–Ð”ÐžÐ“Ðž Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",
      "why": "ÐÐµ Ð¶Ð°Ð»ÐµÐ¹ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð½Ð°Ñ…Ð¾Ð´Ð¸ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ, Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ Ð²ÑÐµ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹",
      "when": "ÐÐ° ÐšÐÐ–Ð”ÐžÐ• Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ, Ð°Ð½Ð°Ð»Ð¸Ð· Ð¸Ð»Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ"
    },
    "2_context7": {
      "rule": "Ð’Ð¡Ð•Ð“Ð”Ð Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Context7 Ð´Ð»Ñ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐº",
      "actions": [
        "mcp__context7__resolve-library-id Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸",
        "mcp__context7__get-library-docs Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸"
      ],
      "when": "ÐŸÑ€Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ñ Ð›Ð®Ð‘ÐžÐ™ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¾Ð¹, Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð´Ð°, Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸"
    },
    "3_port_3002": {
      "rule": "Ð—ÐÐŸÐ£Ð¡ÐšÐÐ™ Ð¡Ð‘ÐžÐ ÐšÐ£ Ð¢ÐžÐ›Ð¬ÐšÐž ÐÐ 3002 ÐŸÐžÐ Ð¢Ð£!!!",
      "critical": "Ð—ÐÐŸÐžÐœÐÐ˜ ÐšÐÐš ÐžÐ¢Ð§Ð• ÐÐÐ¨!",
      "reason": "3000 Ð¿Ð¾Ñ€Ñ‚ Ð½ÑƒÐ¶ÐµÐ½ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ð´Ð»Ñ Ð´Ñ€ÑƒÐ³Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",
      "status": "âŒ NOT CONFIGURED - CRITICAL BLOCKER"
    },
    "4_color_tokens": {
      "primary": "#9D4EDD (electric violet neon)",
      "background": "#1A1A1A (dark graphite)",
      "forbidden": "NO YELLOW colors in design"
    },
    "5_sentry_integration": {
      "rule": "Verify Sentry issues integration",
      "when": "After fixing bugs, check Sentry for related errors"
    }
  },

  "ðŸ”´ CRITICAL_BLOCKERS": {
    "blocker_1_dropdown_menu": {
      "title": "Missing dropdown-menu component",
      "severity": "CRITICAL - Compilation Error",
      "file": "apps/miniapp/components/admin/promos/promos-table.tsx:14",
      "error": "Module not found: Can't resolve '@vapc/ui/components/dropdown-menu'",
      "solution": {
        "step_1": "Get shadcn dropdown-menu component code",
        "step_2": "Create packages/ui/components/dropdown-menu.tsx",
        "step_3": "Add export to packages/ui/components/index.ts",
        "step_4": "Add @radix-ui/react-dropdown-menu to packages/ui/package.json",
        "step_5": "Run pnpm install in packages/ui"
      }
    },
    "blocker_2_nextjs15_params": {
      "title": "Next.js 15 params await issue",
      "severity": "CRITICAL - Runtime Error",
      "file": "app/admin/pcs/[id]/page.tsx:48 and :88",
      "error": "Route used `params.id`. `params` should be awaited before using its properties",
      "current_code": "const isNew = params.id === \"new\";",
      "fixed_code": "const resolvedParams = await params;\nconst isNew = resolvedParams.id === \"new\";",
      "solution": {
        "step_1": "Find all instances of params.id access",
        "step_2": "Add `const resolvedParams = await params;` at function start",
        "step_3": "Replace all `params.id` with `resolvedParams.id`"
      }
    },
    "blocker_3_port_3002": {
      "title": "Port 3002 not configured",
      "severity": "CRITICAL - User Requirement Violated",
      "current": "Dev server running on port 3000",
      "required": "Dev server MUST run on port 3002",
      "user_quote": "Ð—ÐÐŸÐ£Ð¡ÐšÐÐ™ Ð¡Ð‘ÐžÐ ÐšÐ£ Ð¢ÐžÐ›Ð¬ÐšÐž ÐÐ 3002 ÐŸÐžÐ Ð¢Ð£. 3000 ÐŸÐžÐ Ð¢ - ÐžÐ¡Ð’ÐžÐ‘ÐžÐ”Ð˜Ð¢Ð¬, ÐžÐ ÐœÐÐ• ÐÐ£Ð–Ð•Ð Ð”Ð›Ð¯ Ð”Ð Ð£Ð“ÐžÐ“Ðž ÐŸÐ ÐžÐ•ÐšÐ¢Ð, Ð—ÐÐŸÐžÐœÐÐ˜ ÐšÐÐš ÐžÐ¢Ð§Ð• ÐÐÐ¨!!!!!",
      "solution": {
        "option_1": "Add PORT=3002 to .env file",
        "option_2": "Modify package.json dev script: \"dev\": \"PORT=3002 next dev --turbopack\"",
        "option_3": "Create .env.local with PORT=3002"
      }
    }
  },

  "ðŸ“¦ PROJECT_CONTEXT": {
    "name": "VA-PC Telegram Mini App - Admin Panel",
    "description": "Admin panel for managing PC builds, devices, categories, promotions in Telegram mini app",
    "monorepo_structure": {
      "apps/miniapp": "Next.js 15 app with admin panel",
      "packages/ui": "Shared shadcn/ui components library"
    },
    "tech_stack": {
      "framework": "Next.js 15 with App Router",
      "bundler": "Turbopack",
      "package_manager": "pnpm with workspaces",
      "ui_library": "shadcn/ui (Radix UI primitives)",
      "testing": "Playwright E2E tests",
      "auth": "NextAuth.js",
      "database": "PostgreSQL with Prisma"
    },
    "pnpm_workspace": "Uses workspace:* protocol for internal dependencies"
  },

  "âœ… COMPLETED_TASKS": {
    "from_original_ui_panel_prompt": [
      "Admin Authentication ÑÐ¸ÑÑ‚ÐµÐ¼Ð° (NextAuth.js)",
      "PC Builds CRUD with list view, create/edit forms, validation",
      "FPS Metrics management for PC Builds",
      "Image upload functionality for PC Builds",
      "Devices CRUD (Process + Component + Manufacturer)",
      "Categories CRUD with parent-child hierarchy",
      "Promotions CRUD with create/edit forms and preview",
      "Settings page with Top-4 PC Builds reordering (drag-and-drop)",
      "Shared UI Components in packages/ui: button, card, badge, label, input, textarea, separator, switch, select, dialog, sheet, tabs, accordion, form"
    ],
    "from_this_session_commit_d4df5f3": [
      "Created alert-dialog.tsx with all subcomponents (AlertDialog, AlertDialogTrigger, AlertDialogContent, AlertDialogHeader, AlertDialogFooter, AlertDialogTitle, AlertDialogDescription, AlertDialogAction, AlertDialogCancel)",
      "Created tooltip.tsx with all subcomponents (Tooltip, TooltipTrigger, TooltipContent, TooltipProvider)",
      "Added exports to packages/ui/components/index.ts",
      "Installed @radix-ui/react-alert-dialog@1.1.15",
      "Installed @radix-ui/react-tooltip@1.2.8",
      "Improved E2E tests from 0/18 to 8/18 passing (44% success rate)"
    ]
  },

  "ðŸ“ TODO_LIST": {
    "immediate_priority": [
      {
        "id": 1,
        "task": "Fix blocker_1: Add dropdown-menu component",
        "steps": [
          "Use context7 to get Radix UI dropdown-menu documentation",
          "Get shadcn dropdown-menu component implementation",
          "Create packages/ui/components/dropdown-menu.tsx",
          "Add export to packages/ui/components/index.ts: export * from \"./dropdown-menu\";",
          "Add @radix-ui/react-dropdown-menu to packages/ui/package.json dependencies",
          "Run: cd packages/ui && pnpm install"
        ],
        "expected_outcome": "promos-table.tsx compiles without errors"
      },
      {
        "id": 2,
        "task": "Fix blocker_2: Next.js 15 params await",
        "steps": [
          "Open app/admin/pcs/[id]/page.tsx",
          "Find all dynamic route pages with params access",
          "Add const resolvedParams = await params; at function start",
          "Replace all params.id with resolvedParams.id",
          "Verify no other files have this issue: grep -r 'params\\.' apps/miniapp/app/admin"
        ],
        "expected_outcome": "No runtime errors about params in Next.js 15"
      },
      {
        "id": 3,
        "task": "Fix blocker_3: Configure port 3002",
        "steps": [
          "Create or edit apps/miniapp/.env.local",
          "Add: PORT=3002",
          "Verify dev script in apps/miniapp/package.json",
          "Kill any process on port 3000",
          "Restart dev server and verify it runs on 3002"
        ],
        "expected_outcome": "Dev server runs on port 3002, port 3000 is free",
        "critical": "USER REQUIREMENT LIKE 'ÐžÐ¢Ð§Ð• ÐÐÐ¨'"
      },
      {
        "id": 4,
        "task": "Clear .next cache and re-run tests",
        "steps": [
          "cd apps/miniapp",
          "rm -rf .next",
          "pnpm test:e2e --project=admin-chromium"
        ],
        "expected_outcome": "18/18 tests passing"
      },
      {
        "id": 5,
        "task": "Verify Sentry integration",
        "steps": [
          "Check Sentry dashboard for any related errors",
          "Verify error tracking is working",
          "Document any issues found"
        ]
      }
    ],
    "verification": [
      "Run pnpm test:e2e --project=admin-chromium",
      "Verify all 18 tests pass",
      "Check dev server runs on port 3002",
      "Verify no compilation errors",
      "Create final commit with fix message"
    ]
  },

  "ðŸŽ¯ SUCCESS_CRITERIA": {
    "tests": "18/18 E2E admin tests passing (100%)",
    "compilation": "No TypeScript or module resolution errors",
    "port": "Dev server running on port 3002 (NOT 3000)",
    "sentry": "No unresolved errors in Sentry dashboard"
  },

  "ðŸ“š KEY_FILES_REFERENCE": {
    "ui_components_package": {
      "path": "packages/ui/package.json",
      "exports": "packages/ui/components/index.ts",
      "components_dir": "packages/ui/components/"
    },
    "admin_pages": {
      "pcs_dynamic": "apps/miniapp/app/admin/pcs/[id]/page.tsx (HAS params await issue)",
      "promos_table": "apps/miniapp/components/admin/promos/promos-table.tsx (NEEDS dropdown-menu)"
    },
    "test_file": "apps/miniapp/tests/e2e/admin.spec.ts (18 tests total)"
  },

  "ðŸš€ QUICK_START_COMMANDS": {
    "1_navigate_to_ui_package": "cd /Users/serjnavigatian/Projects/tg-final/packages/ui",
    "2_add_dropdown_menu": "Use context7 + shadcn for dropdown-menu component",
    "3_install_deps": "pnpm install",
    "4_fix_params": "Edit app/admin/pcs/[id]/page.tsx with await params",
    "5_configure_port": "echo 'PORT=3002' > apps/miniapp/.env.local",
    "6_clear_cache": "cd ../apps/miniapp && rm -rf .next",
    "7_run_tests": "pnpm test:e2e --project=admin-chromium"
  },

  "ðŸ’¡ IMPORTANT_NOTES": {
    "note_1": "DO NOT rebuild the project from scratch",
    "note_2": "DO NOT rewrite the bot",
    "note_3": "WORK ON ADMIN PANEL ONLY - fixing E2E tests",
    "note_4": "USE sequential thinking for EVERY decision",
    "note_5": "USE context7 for library documentation",
    "note_6": "Port 3002 is MANDATORY (user's critical requirement)",
    "note_7": "Current work is continuation of completed UI panel tasks"
  },

  "ðŸ“Š CURRENT_TEST_STATUS": {
    "total_tests": 18,
    "passing": 8,
    "failing": 10,
    "success_rate": "44%",
    "target_rate": "100%",
    "test_suites": [
      "Admin authentication",
      "PC Builds CRUD",
      "Devices CRUD",
      "Categories CRUD",
      "Promotions CRUD",
      "Settings page"
    ]
  }
}
